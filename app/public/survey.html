<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Take the Friend Finder Survey</title>
	  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
  <script src="https://code.jquery.com/jquery.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
  <!--google font link-->
<link href="https://fonts.googleapis.com/css?family=Averia+Serif+Libre" rel="stylesheet">
<!--link to chosen CDN-->
<!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/chosen/1.5.1/chosen.css"> -->
<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/chosen/1.5.1/chosen.jquery.min.js"></script>
 -->
<style>

form{

	background-color:rgba(0,0,0,0.5);
	color:white;
	padding-right: 50px;
	padding-bottom: 50px;
	padding-left: 50px;
	padding-top: 10px;
	font-family: 'Averia Serif Libre', cursive;
}

p {
	font-family: 'Averia Serif Libre', cursive;
	color:black;
}

h1, h4 {
	font-family: 'Averia Serif Libre', cursive;


}

a {
	font-family: 'Averia Serif Libre', cursive;
	color: white;
	font-size: larger;
}

input, select, textarea{
    color: black;
}

textarea:focus, input:focus {
    color: black;
}

.img-responsive{
	
	max-height: 200px; 
	max-width: 200px;
}

.modal-content{
	background-color: rgba(0,0,0,0.5);
	color:white;

}

.nav{
	background-color:rgba(0,0,0,0.5);
	color:white;
}

.btn-primary{
	opacity: .9;

}

label{

	font-weight: normal;
}

body{
	background: url("https://s3.amazonaws.com/zam-www/assets/editorial/2017/01/ffxv_road.jpg");	
	background-repeat: no-repeat;
	background-position: center center;
	background-attachment: fixed;
	-webkit-background-size: cover;
	-moz-background-size: cover;
	-o-background-size: cover;
	background-size: cover;
}

</style>

</head>
<body>
<div class ="container">
<nav class="navbar navbar-inverse">
  <div class="container-fluid">
    <div class="navbar-header">
      <a class="navbar-brand" href="/home">Final Friend Finder</a>
    </div>
    <ul class="nav navbar-nav">
      <li class="active"><a href="/home">Home</a></li>
      <li><a href="/api/friends">Friends List</a></li>
      <li><a href="https://github.com/LaurelFH/FriendFinder">GitHub</a></li>

    </ul>
  </div>
</nav>

	<!-- <form class ="form-horizontal"> -->
	<form>
	<h1>Before hopping in, tell us about yourself...</h1>
	<!-- <h2>Who will join you on your next adventure?</h2> -->
	<!--for spacing purposes also for the choices, are these selects or dorpdown menus?-->
	<div class ="form-group">
		<label for ="inputName">What is your name?(Required)</label>
		<input type ="text" id="inputName" placeholder="Your Name">
	</div>
	<div class ="form-group">
		<label for ="inputName">What do you look like?(Required)</label>
		<input type ="text" id="inputPhoto" placeholder="https://your_photo_url">
	</div>	
	<div class ="form-group"><!--starts question-->
		<label for ="question1"><h3>Question 1</h3></label>
		<h4>You have a talent for the culinary arts and love cooking for others</h4>
		<!--Selects be sure to add the script links for chosen-->	    
			<select class="form-control" id ="question1">
			  <option value ="1">1 (Strongly Disagree)</option>
			  <option value ="2">2</option>
			  <option value ="3">3</option>
			  <option value ="4">4</option>
			  <option value ="5">5 (Strongly Agree)</option>
			</select>
	</div><!--ends question div-->

	<div class ="form-group"><!--starts question-->
		<label for ="question2"><h3>Question 2</h3></label>
		<h4>You inspire joy in others, and are often found singing and dancing every day</h4>
		<!--Selects be sure to add the script links for chosen-->	    
			<select class="form-control" id ="question2">
			  <option value ="1">1 (Strongly Disagree)</option>
			  <option value ="2">2</option>
			  <option value ="3">3</option>
			  <option value ="4">4</option>
			  <option value ="5">5 (Strongly Agree)</option>
			</select>
	</div><!--ends question div-->
	
		<div class ="form-group"><!--starts question-->
		<label for ="question3"><h3>Question 3</h3></label>
		<h4> You think loyalty is the most important virtue </h4>
		<!--Selects be sure to add the script links for chosen-->	    
			<select class="form-control" id ="question3">
			  <option value ="1">1 (Strongly Disagree)</option>
			  <option value ="2">2</option>
			  <option value ="3">3</option>
			  <option value ="4">4</option>
			  <option value ="5">5 (Strongly Agree)</option>
			</select>
	</div><!--ends question div-->
		<div class ="form-group"><!--starts question-->
		<label for ="question3"><h3>Question 4</h3></label>
		<h4> You are often awestruck by nature's beauty</h4>
		<!--Selects be sure to add the script links for chosen-->	    
			<select class="form-control" id ="question4">
			  <option value ="1">1 (Strongly Disagree)</option>
			  <option value ="2">2</option>
			  <option value ="3">3</option>
			  <option value ="4">4</option>
			  <option value ="5">5 (Strongly Agree)</option>
			</select>
	</div><!--ends question div-->
			<div class ="form-group"><!--starts question-->
		<label for ="question3"><h3>Question 5</h3></label>
		<h4> You feel obligated to protect those who are vulnerable</h4>
		<!--Selects be sure to add the script links for chosen-->	    
			<select class="form-control" id ="question5">
			  <option value ="1">1 (Strongly Disagree)</option>
			  <option value ="2">2</option>
			  <option value ="3">3</option>
			  <option value ="4">4</option>
			  <option value ="5">5 (Strongly Agree)</option>
			</select>
	</div><!--ends question div-->
			<div class ="form-group"><!--starts question-->
		<label for ="question3"><h3>Question 6</h3></label>
		<h4> You have to work out both your body and mind</h4>
		<!--Selects be sure to add the script links for chosen-->	    
			<select class="form-control" id ="question6">
			  <option value ="1">1 (Strongly Disagree)</option>
			  <option value ="2">2</option>
			  <option value ="3">3</option>
			  <option value ="4">4</option>
			  <option value ="5">5 (Strongly Agree)</option>
			</select>
	</div><!--ends question div-->
			<div class ="form-group"><!--starts question-->
		<label for ="question3"><h3>Question 7</h3></label>
		<h4> You have felt the need to reinvent yourself</h4>
		<!--Selects be sure to add the script links for chosen-->	    
			<select class="form-control" id ="question7">
			  <option value ="1">1 (Strongly Disagree)</option>
			  <option value ="2">2</option>
			  <option value ="3">3</option>
			  <option value ="4">4</option>
			  <option value ="5">5 (Strongly Agree)</option>
			</select>
	</div><!--ends question div-->
			<div class ="form-group"><!--starts question-->
		<label for ="question3"><h3>Question 8</h3></label>
		<h4> You love to travel and explore</h4>
		<!--Selects be sure to add the script links for chosen-->	    
			<select class="form-control" id ="question8">
			  <option value ="1">1 (Strongly Disagree)</option>
			  <option value ="2">2</option>
			  <option value ="3">3</option>
			  <option value ="4">4</option>
			  <option value ="5">5 (Strongly Agree)</option>
			</select>
	</div><!--ends question div-->
			<div class ="form-group"><!--starts question-->
		<label for ="question3"><h3>Question 9</h3></label>
		<h4> You prefer to be more of a lone wolf</h4>
		<!--Selects be sure to add the script links for chosen-->	    
			<select class="form-control" id ="question9">
			  <option value ="1">1 (Strongly Disagree)</option>
			  <option value ="2">2</option>
			  <option value ="3">3</option>
			  <option value ="4">4</option>
			  <option value ="5">5 (Strongly Agree)</option>
			</select>
	</div><!--ends question div-->
			<div class ="form-group"><!--starts question-->
		<label for ="question3"><h3>Question 10</h3></label>
		<h4> You think bright colors are always stylish</h4>
		<!--Selects be sure to add the script links for chosen-->	    
			<select class="form-control" id ="question10">
			  <option value ="1">1 (Strongly Disagree)</option>
			  <option value ="2">2</option>
			  <option value ="3">3</option>
			  <option value ="4">4</option>
			  <option value ="5">5 (Strongly Agree)</option>
			</select>
	</div><!--ends question div-->
	<!--submit button-->

	<button type ="submit" class="btn btn-primary btn-lg btn-block" id ="submit"> Submit Answers</button>
	</form>

<!-- Modal -->
<div id="myModal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Here's Your Final Friend</h4>
      </div>
      <div class="modal-body" >
        <div id ="displayNewFriend">
        <p>Your friend's name goes here.</p>
        </div>
        <div id = "displayFriendPhoto">
        </div>
      </div>
       
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>

  </div>
</div>


</div><!--ends fluid container-->
</body>

<!--FUNCTIONS FOR THE AJAX CALL AND RESULTS-->
<script type ="text/javascript">
//JS to display info in a modal for the friend result
//ajax call to the friends api
function displayFriend(newUser){

	var currentURL = window.location.origin;
	$.ajax({url: currentURL + "/api/friends", method: "GET"})
	.done(function(friendsInfo){
		console.log("--------------");
		console.log("URL:" + currentURL + "/api/friends");
		console.log(friendsInfo);
		console.log("-------------");

		//need to store these differences for later??? May not actually be able to have the people here though (just the numbers)
		var totalDifferencesArray = [];

		for (var friendIndex = 0; friendIndex < friendsInfo.length; friendIndex++){
			// console.log(friendsInfo[i]); new iterator name?
			console.log("these are all of your friends' scores"+ friendsInfo[friendIndex].scores);
			//insert infor for the dynamic div element for the friend?  this will give all the info, but maybe they want just one?
			//loop through the score array and compare differences between them from 1 user to another -- need friendsiNfo @ friendIndex and then their score
			var totalDifference = 0; 
			//DECLARE NEWUSER VARIBALE HERE FOR THE FOR LOOP ERROR IN 174 (NEWUSER'S SCOPE IS MESSED UP)?
			// var newUser = {};//--maybe a parameter?

			for(var scoreIndex = 0; scoreIndex < friendsInfo[friendIndex].scores.length; scoreIndex++){
				//get the 1 to 1 scores from this friends score info-- loop through to get these score components 
				//this friend's score @ this value in the score array?-->  
				// need to get the single score values? to setup the comparison 
				//RETEST THIS STEP FOR THE CORRECT DIFFERENCES 
				 totalDifference += Math.abs(friendsInfo[friendIndex].scores[scoreIndex]- newUser.scores[scoreIndex]);
			}//ends inner loop			
		//add the users to the totalDifferencesArray to display later?
		//have total difference for user, plus the total differences array???
		(totalDifferencesArray).push(totalDifference);
		//consoles the scores in the totalDifferencesArray
		console.log("this is the result for the total differences array" + totalDifferencesArray);
		}//ends outer friend loop

		//after totalDiffernece, need to find person with the LEAST difference from my friends array 
		 var minDifference = Math.min.apply(null, totalDifferencesArray);
		 var bestFriendIndex = totalDifferencesArray.indexOf(minDifference);
		//for loop to figure out where the index of that min number is and get the user?
			// for(var differencesIndex = 0; differencesIndex < totalDifferencesArray.length; differencesIndex++){
			// 	if(minDifference == totalDifferencesArray[differencesIndex]){
			// 		bestFriendIndex == differencesIndex; 
			// 	}
			// }//end for loop for the differences in the array 
		//get friend out of friendsInfo array 
		console.log("your best friend min difference is" + minDifference + "and index position is" + bestFriendIndex);
		console.log("this means your best friend is" + friendsInfo[bestFriendIndex].name);

		//activate the modal with the best friend's name and photo
		var yourFinalFriend = friendsInfo[bestFriendIndex].name; 
		var yourFinalFriendPhoto = friendsInfo[bestFriendIndex].photo;
		$("#myModal").modal('show');
				//double check .html versus .text here 
		$("#displayNewFriend").text(yourFinalFriend);//works
		$("#displayFriendPhoto").html("<img src="+ yourFinalFriendPhoto +" class='img-responsive'"+">");

		//call the post so the user goes in the array?
		// $.post('/api/friends', JSON.stringify(newUser));
		$.post('/api/friends', newUser);
	});
}

//could just make this a submit click event?
//add html tags here for the photo ot later--? decide after seeing modal?
$("#submit").on("click", function(event){
	event.preventDefault();
	
	var quest1 = parseInt($("#question1").val());
	var quest2 = parseInt($("#question2").val());
	var quest3 = parseInt($("#question3").val());
	var quest4 = parseInt($("#question4").val());
	var quest5 = parseInt($("#question5").val());
	var quest6 = parseInt($("#question6").val());
	var quest7 = parseInt($("#question7").val());
	var quest8 = parseInt($("#question8").val());
	var quest9 = parseInt($("#question9").val());
	var quest10 = parseInt($("#question10").val());

	var newUser = {
		name: $("#inputName").val().trim(),
		photo: $("#inputPhoto").val().trim(),
		//check the syntax for this, need to be set as another array as above;  [] sepertaed by commas-- worth a .slice?
		//returned the scores as strings, not numbers??? var arrayOfNumbers = arrayOfStrings.map(Number);
		scores: [quest1, quest2, quest3, quest4, quest5, quest6, quest7, quest8, quest9, quest10]
	};
	console.log(newUser.name);
	console.log(newUser.photo);
	console.log(newUser.scores);

		displayFriend(newUser);

});

//https://harvesthq.github.io/chosen/#standard-select



</script>
</html>