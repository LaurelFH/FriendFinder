<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Take the Friend Finder Survey</title>
	  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
  <script src="https://code.jquery.com/jquery.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
  <!--google font link-->
<link href="https://fonts.googleapis.com/css?family=Averia+Serif+Libre" rel="stylesheet">
<!--link to chosen CDN-->
<!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/chosen/1.5.1/chosen.css"> -->
<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/chosen/1.5.1/chosen.jquery.min.js"></script>
 -->
<style>

form{

	background-color:rgba(0,0,0,0.5);
	color:white;
	padding-right: 50px;
	padding-bottom: 50px;
	padding-left: 50px;
	padding-top: 10px;
	font-family: 'Averia Serif Libre', cursive;
}

p {
	font-family: 'Averia Serif Libre', cursive;
	color:black;
}

h1, h4 {
	font-family: 'Averia Serif Libre', cursive;


}

a {
	font-family: 'Averia Serif Libre', cursive;
	color: white;
	font-size: larger;
}

body{
	background: url("https://s3.amazonaws.com/zam-www/assets/editorial/2017/01/ffxv_road.jpg");	
	background-repeat: no-repeat;
	background-position: center center;
	background-attachment: fixed;
	-webkit-background-size: cover;
	-moz-background-size: cover;
	-o-background-size: cover;
	background-size: cover;
}

</style>

</head>
<body>
<div class ="container">

	<!-- <form class ="form-horizontal"> -->
	<form>
	<h1> Tell Us About Yourself</h1>
	<!--for spacing purposes also for the choices, are these selects or dorpdown menus?-->
<!-- 	<div class = "form-group">
		<label for ="inputEmail">Email</label>
		<input type ="email" id="inputEmail" placeholder ="Your Email">
	</div> -->
	<div class ="form-group">
		<label for ="inputName">Your Name</label>
		<input type ="text" id="inputName" placeholder="Your Name">
	</div>
	<div class ="form-group">
		<label for ="inputName">Your Photo</label>
		<input type ="text" id="inputPhoto" placeholder="https://your_photo_url">
	</div>	
	<div class ="form-group"><!--starts question-->
		<label for ="question1"><h3>Question 1</h3></label>
		<h4> I love cooking for others</h4>
		<!--Selects be sure to add the script links for chosen-->	    
			<select class="form-control" id ="question1">
			  <option value ="1">1 (Strongly Disagree)</option>
			  <option value ="2">2</option>
			  <option value ="3">3</option>
			  <option value ="4">4</option>
			  <option value ="5">5 (Strongly Agree)</option>
			</select>
	</div><!--ends question div-->

	<div class ="form-group"><!--starts question-->
		<label for ="question2"><h3>Question 2</h3></label>
		<h4> I could sing and dance all day</h4>
		<!--Selects be sure to add the script links for chosen-->	    
			<select class="form-control" id ="question2">
			  <option value ="1">1 (Strongly Disagree)</option>
			  <option value ="2">2</option>
			  <option value ="3">3</option>
			  <option value ="4">4</option>
			  <option value ="5">5 (Strongly Agree)</option>
			</select>
	</div><!--ends question div-->
	
		<div class ="form-group"><!--starts question-->
		<label for ="question3"><h3>Question 3</h3></label>
		<h4> I think loyalty is the most important virtue</h4>
		<!--Selects be sure to add the script links for chosen-->	    
			<select class="form-control" id ="question3">
			  <option value ="1">1 (Strongly Disagree)</option>
			  <option value ="2">2</option>
			  <option value ="3">3</option>
			  <option value ="4">4</option>
			  <option value ="5">5 (Strongly Agree)</option>
			</select>
	</div><!--ends question div-->
	
	<!--submit button-->

	<button type ="submit" class="btn btn-primary btn-lg btn-block" id ="submit"> Submit Answers</button>
	</form>

<!--insert modal info here with jquery to push the name and photo of the best friend to the user-->
<!-- <!Trigger the modal with a button -->
<!-- <button type="button" class="btn btn-info btn-lg" data-toggle="modal" data-target="#myModal">Open Modal</button> --> -->

<!-- Modal -->
<div id="myModal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Here's Your Final Friend</h4>
      </div>
      <div class="modal-body" >
        <div id ="displayNewFriend">
        <p>Your friend's name goes here.</p>
        </div>
        <div id = "displayFriendPhoto">
        </div>
      </div>
       
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>

  </div>
</div>


</div><!--ends fluid container-->
</body>

<!--FUNCTIONS FOR THE AJAX CALL AND RESULTS-->
<script type ="text/javascript">
//JS to display info in a modal for the friend result
//ajax call to the friends api
function displayFriend(newUser){

	var currentURL = window.location.origin;
	$.ajax({url: currentURL + "/api/friends", method: "GET"})
	.done(function(friendsInfo){
		console.log("--------------");
		console.log("URL:" + currentURL + "/api/friends");
		console.log(friendsInfo);
		console.log("-------------");

		//need to store these differences for later??? May not actually be able to have the people here though (just the numbers)
		var totalDifferencesArray = [];

		for (var friendIndex = 0; friendIndex < friendsInfo.length; friendIndex++){
			// console.log(friendsInfo[i]); new iterator name?
			console.log("these are all of your friends' scores"+ friendsInfo[friendIndex].scores);
			//insert infor for the dynamic div element for the friend?  this will give all the info, but maybe they want just one?
			//loop through the score array and compare differences between them from 1 user to another -- need friendsiNfo @ friendIndex and then their score
			var totalDifference = 0; 
			//DECLARE NEWUSER VARIBALE HERE FOR THE FOR LOOP ERROR IN 174 (NEWUSER'S SCOPE IS MESSED UP)?
			// var newUser = {};//--maybe a parameter?

			for(var scoreIndex = 0; scoreIndex < friendsInfo[friendIndex].scores.length; scoreIndex++){
				//get the 1 to 1 scores from this friends score info-- loop through to get these score components 
				//this friend's score @ this value in the score array?-->  
				// need to get the single score values? to setup the comparison 
				//RETEST THIS STEP FOR THE CORRECT DIFFERENCES 
				 totalDifference += Math.abs(friendsInfo[friendIndex].scores[scoreIndex]- newUser.scores[scoreIndex]);
			}//ends inner loop			
		//add the users to the totalDifferencesArray to display later?
		//have total difference for user, plus the total differences array???
		(totalDifferencesArray).push(totalDifference);
		//consoles the scores in the totalDifferencesArray
		console.log("this is the result for the total differences array" + totalDifferencesArray);
		}//ends outer friend loop

		//after totalDiffernece, need to find person with the LEAST difference from my friends array 
		 var minDifference = Math.min.apply(null, totalDifferencesArray);
		 var bestFriendIndex = totalDifferencesArray.indexOf(minDifference);
		//for loop to figure out where the index of that min number is and get the user?
			// for(var differencesIndex = 0; differencesIndex < totalDifferencesArray.length; differencesIndex++){
			// 	if(minDifference == totalDifferencesArray[differencesIndex]){
			// 		bestFriendIndex == differencesIndex; 
			// 	}
			// }//end for loop for the differences in the array 
		//get friend out of friendsInfo array 
		console.log("your best friend min difference is" + minDifference + "and index position is" + bestFriendIndex);
		console.log("this means your best friend is" + friendsInfo[bestFriendIndex].name);

		//activate the modal with the best friend's name and photo
		var yourFinalFriend = friendsInfo[bestFriendIndex].name; 
		var yourFinalFriendPhoto = friendsInfo[bestFriendIndex].photo;
		$("#myModal").modal('show');
				//double check .html versus .text here 
		$("#displayNewFriend").text(yourFinalFriend);//works
		$("#displayFriendPhoto").html("<img src="+ yourFinalFriendPhoto +">");

		//call the post so the user goes in the array?
		// $.post('/api/friends', JSON.stringify(newUser));
		$.post('/api/friends', newUser);
	});
}

//could just make this a submit click event?
//add html tags here for the photo ot later--? decide after seeing modal?
$("#submit").on("click", function(event){
	event.preventDefault();
	
	var quest1 = parseInt($("#question1").val());
	var quest2 = parseInt($("#question2").val());
	var quest3 = parseInt($("#question3").val());
	

	var newUser = {
		name: $("#inputName").val().trim(),
		photo: $("#inputPhoto").val().trim(),
		//check the syntax for this, need to be set as another array as above;  [] sepertaed by commas-- worth a .slice?
		//returned the scores as strings, not numbers??? var arrayOfNumbers = arrayOfStrings.map(Number);
		scores: [quest1, quest2, quest3]
	};
	console.log(newUser.name);
	console.log(newUser.photo);
	console.log(newUser.scores);
		// var newUser.scores = newUser.map();
		//http://api.jquery.com/jQuery.makeArray/
		//https://stackoverflow.com/questions/15677869/how-to-convert-a-string-of-numbers-to-an-array-of-numbers
	// 	$.map(newUser.sc)
	// console.log(newUser.scores);
//post the new friend to the api localhost page!!!!
	// $.post("/api/friends", newUser)
	// .done(function(newFriend){
	// 	console.log("You just added" + newFriend);
	// 	});

		// getNewResponses();
		displayFriend(newUser);



});

//https://harvesthq.github.io/chosen/#standard-select

// function getNewResponses(responses){
// //check if the responses aren't null and are selected
// 	if(document.getElementById(responses) !=null && document.getElementById(responses).selected){
// 		//once check is complete, grab the values of each of the questions from the user and save it as the new user array
// 		// $("#question1 :selected").text();
// 		var name = $("#inputName").val().trim();
// 		var photo = $("#inputPhoto").val().trim();
// 		console.log(name);
// 		console.log(photo);
// 		//select menu options for the scores
// 		var quest1 = $("#question1").val();
// 		var quest2 = $("#question2").val();
// 		var quest3 = $("#question3").val();
// 		console.log(quest1);
// 		console.log(quest2);

// 	}



// }


////////////////// CALL FUNCTIONS 
//console.log all the users in the friends array
// $(document).ready(function(){
	
// 	getNewResponses();
// 	displayFriend();

// });
//prevent the submit button from going through 
// $("#submit").on("click", function(event){
// 	event.preventDefault();

// });





</script>
</html>